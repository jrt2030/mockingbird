#! /usr/bin/env node
let { MockingServer } = require('../dist/lib/server');
let { MockingEngine } = require('../dist/lib/engine/mockEngine');

let simulators = require('../dist/lib/engine/simulators');
let engine = new MockingEngine();

const { MOCKINGBIRD_SERVICE_PORT = 3333 } = process.env;

engine.loadSimulators([
  new simulators.DelaySimulator({ namespace: "delay"}),
  new simulators.ConnectionSimulator({ namespace: "connection" }),
  new simulators.HeaderSimulator({ namespace: "header" }),
  new simulators.BodySimulator({ namespace: "body" })]
);

let serverConfig = {
    port: MOCKINGBIRD_SERVICE_PORT,
    debug: true,
    engine: engine    
}

let mockingServer = new MockingServer(serverConfig);

mockingServer.startService();